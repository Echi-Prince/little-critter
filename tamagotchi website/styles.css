:root{
  --bg:#0b0f14;
  --ink:#e9ffef;
  --muted:#a6c7b0;
  --accent:#4cff90;
  --accent2:#39c6ff;
  --warn:#ffd166;
  --bad:#ff5c7a;

  --stroke:#2a3b52;
  --radius:18px;
  --shadow:0 18px 40px rgba(0,0,0,.45);
  --font:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;
  --mono:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;

  --lcd-ink:#0e2516;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:var(--font);
  background:radial-gradient(1200px 700px at 20% 0%, #1a2a2a 0%, var(--bg) 55%, #070a0e 100%);
  color:var(--ink);
}

.bg-grid{
  position:fixed; inset:0;
  background-image:
    linear-gradient(to right, rgba(76,255,144,.05) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(76,255,144,.05) 1px, transparent 1px);
  background-size:44px 44px;
  pointer-events:none;
  opacity:.9;
  mask-image:radial-gradient(closest-side at 40% 20%, rgba(0,0,0,1), rgba(0,0,0,.2));
}

/* Topbar */
.topbar{
  display:flex; align-items:center; justify-content:space-between;
  padding:18px 20px;
  border-bottom:1px solid rgba(42,59,82,.65);
  background:linear-gradient(180deg, rgba(19,26,37,.92), rgba(12,16,22,.65));
  position:sticky; top:0; z-index:10;
  backdrop-filter:blur(8px);
}
.brand{display:flex; gap:12px; align-items:center}
.logo{
  width:38px;height:38px;border-radius:12px;
  display:grid;place-items:center;
  background:linear-gradient(180deg, rgba(76,255,144,.18), rgba(57,198,255,.12));
  border:1px solid rgba(76,255,144,.35);
  box-shadow:0 10px 25px rgba(0,0,0,.35);
  font-weight:900;
}
.brand-title{font-weight:900; letter-spacing:.6px}
.brand-sub{color:var(--muted); font-size:.88rem}

.toggles{display:flex; gap:10px; align-items:center}
.chip{
  border:1px solid rgba(42,59,82,.85);
  background:rgba(15,21,32,.8);
  color:var(--ink);
  padding:10px 12px;
  border-radius:999px;
  cursor:pointer;
  font-weight:700;
}
.chip:hover{border-color:rgba(76,255,144,.6)}
.chip.danger:hover{border-color:rgba(255,92,122,.7)}

/* Layout */
.shell{
  width:min(1120px, 92vw);
  margin:22px auto;
  display:grid;
  grid-template-columns:1.2fr .8fr;
  gap:18px;
}
@media (max-width:980px){ .shell{grid-template-columns:1fr} }

/* Device */
.device{
  background:linear-gradient(180deg, rgba(19,26,37,.88), rgba(10,13,18,.88));
  border:1px solid rgba(42,59,82,.85);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  overflow:hidden;
}

/* Shell cosmetics */
.device.shell-aqua{
  border-color: rgba(57,198,255,.7);
  background: linear-gradient(180deg, rgba(13,29,40,.92), rgba(7,14,18,.92));
}
.device.shell-neon{
  border-color: rgba(76,255,144,.75);
  background: linear-gradient(180deg, rgba(10,35,22,.92), rgba(6,12,10,.92));
}

.device-top{
  display:flex; justify-content:space-between; gap:16px;
  padding:16px 16px 0 16px;
}
.status-lights{display:flex; gap:8px; padding-top:4px}
.light{
  width:10px;height:10px;border-radius:999px;
  background:rgba(76,255,144,.35);
  border:1px solid rgba(76,255,144,.55);
  box-shadow:0 0 18px rgba(76,255,144,.18);
}
.light:nth-child(2){background:rgba(57,198,255,.35); border-color:rgba(57,198,255,.55)}
.light:nth-child(3){background:rgba(255,209,102,.35); border-color:rgba(255,209,102,.55)}

.pet-meta{
  display:grid; gap:6px;
  margin-left:auto;
  font-family:var(--mono);
  color:var(--muted);
}
.meta-line{display:flex; gap:10px; justify-content:flex-end}
.meta-line .value{color:var(--ink); font-weight:900}

.screen-wrap{padding:16px}
.screen{
  position:relative;
  background:linear-gradient(180deg, rgba(201,255,216,.95), rgba(168,235,192,.92));
  color:var(--lcd-ink);
  border-radius:18px;
  border:2px solid rgba(14,37,22,.45);
  box-shadow:inset 0 0 0 4px rgba(14,37,22,.12);
  padding:14px;
  overflow:hidden;
}
.scanlines{
  position:absolute; inset:0;
  background:repeating-linear-gradient(
    to bottom,
    rgba(14,37,22,.08),
    rgba(14,37,22,.08) 2px,
    rgba(14,37,22,.02) 4px,
    rgba(14,37,22,.02) 6px
  );
  opacity:.55;
  pointer-events:none; /* CRITICAL: never block clicks */
  mix-blend-mode:multiply;
}

.screen-header{
  display:flex; justify-content:space-between; align-items:baseline;
  font-family:var(--mono);
  margin-bottom:10px;
}
.lcd-title{letter-spacing:1.2px; font-weight:900}
.lcd-clock{font-weight:900}

.pet-area{
  position:relative;
  height:210px;
  border-radius:14px;
  border:2px solid rgba(14,37,22,.35);
  background:
    radial-gradient(circle at 30% 30%, rgba(14,37,22,.12), transparent 45%),
    radial-gradient(circle at 70% 60%, rgba(14,37,22,.10), transparent 55%),
    rgba(255,255,255,.25);
  display:grid;
  place-items:center;
  margin-bottom:12px;
}

/* Pet */
.pet{
  width:88px; height:88px;
  position:relative;
  image-rendering:pixelated;
  filter:drop-shadow(0 6px 0 rgba(14,37,22,.15));
}
.pet::before{
  content:"";
  position:absolute; inset:0;
  border-radius:18px;
  background:
    linear-gradient(180deg, rgba(14,37,22,.18), transparent 40%),
    rgba(14,37,22,.18);
  box-shadow:
    inset 0 0 0 6px rgba(14,37,22,.22),
    inset 0 0 0 12px rgba(255,255,255,.25);
}
.pet::after{
  content:"";
  position:absolute; left:18px; right:18px; top:26px; height:40px;
  background:
    radial-gradient(circle at 22% 40%, rgba(14,37,22,.95) 0 4px, transparent 5px),
    radial-gradient(circle at 78% 40%, rgba(14,37,22,.95) 0 4px, transparent 5px),
    radial-gradient(circle at 50% 70%, rgba(14,37,22,.95) 0 3px, transparent 4px);
  opacity:.92;
}

/* Accessories */
.pet-acc{position:absolute; inset:0; pointer-events:none}
.pet[data-acc="cap"] .pet-acc::before{
  content:""; position:absolute; left:10px; right:10px; top:6px; height:22px;
  border-radius:12px 12px 10px 10px;
  background:rgba(14,37,22,.72);
  box-shadow:inset 0 -4px 0 rgba(255,255,255,.18);
}
.pet[data-acc="cap"] .pet-acc::after{
  content:""; position:absolute; left:16px; right:16px; top:22px; height:8px;
  border-radius:999px; background:rgba(14,37,22,.62);
}
.pet[data-acc="bow"] .pet-acc::before{
  content:""; position:absolute; left:30px; top:8px; width:28px; height:18px;
  background:
    radial-gradient(circle at 25% 50%, rgba(255,92,122,.85) 0 7px, transparent 8px),
    radial-gradient(circle at 75% 50%, rgba(255,92,122,.85) 0 7px, transparent 8px),
    radial-gradient(circle at 50% 50%, rgba(255,209,102,.92) 0 4px, transparent 5px);
}
.pet[data-acc="shades"] .pet-acc::before{
  content:""; position:absolute; left:14px; right:14px; top:32px; height:16px;
  background:
    radial-gradient(circle at 28% 55%, rgba(0,0,0,.75) 0 9px, transparent 10px),
    radial-gradient(circle at 72% 55%, rgba(0,0,0,.75) 0 9px, transparent 10px),
    linear-gradient(90deg, transparent 0 40%, rgba(0,0,0,.62) 40% 60%, transparent 60% 100%);
  opacity:.9;
}

/* Pet animations */
.pet.idle{animation:bob 1.4s ease-in-out infinite}
.pet.happy{animation:bob 1s ease-in-out infinite, wiggle .35s ease-in-out 6}
.pet.sad{filter:drop-shadow(0 6px 0 rgba(14,37,22,.12)) grayscale(.1)}
.pet.sleep{opacity:.65; animation:none}
.pet.dirty::before{box-shadow: inset 0 0 0 6px rgba(14,37,22,.22), inset 0 0 0 12px rgba(255,255,255,.25), 0 0 0 2px rgba(255,92,122,.25)}
@keyframes bob{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}
@keyframes wiggle{0%,100%{transform:rotate(0)}25%{transform:rotate(-6deg)}75%{transform:rotate(6deg)}}

.bubble{
  position:absolute; top:14px; right:14px;
  padding:8px 10px;
  border-radius:12px;
  border:2px solid rgba(14,37,22,.35);
  background:rgba(255,255,255,.55);
  font-family:var(--mono);
  font-weight:900;
}
.hidden{display:none}

/* Modal */
.modal{
  position:absolute; inset:0;
  display:grid; place-items:center;
  background: rgba(14,37,22,.12);
  backdrop-filter: blur(2px);
  z-index:999;               /* ensure above everything */
  pointer-events:auto;
}
/* Hard guarantee: never show when hidden */
.modal.hidden{display:none !important;}

.modal-card{
  width:min(420px, 92%);
  border-radius:16px;
  border:2px solid rgba(14,37,22,.35);
  background:rgba(255,255,255,.62);
  box-shadow:0 18px 40px rgba(0,0,0,.25);
  padding:12px;
  font-family:var(--mono);
}
.modal-head{
  display:flex; align-items:center; justify-content:space-between;
  border-bottom:1px dashed rgba(14,37,22,.35);
  padding-bottom:8px; margin-bottom:10px;
}
.modal-title{font-weight:900; letter-spacing:1px}
.xbtn{
  border:1px solid rgba(14,37,22,.35);
  background:rgba(255,255,255,.45);
  width:34px;height:34px;border-radius:12px;
  font-size:22px; cursor:pointer;
}
.xbtn:hover{border-color:rgba(57,198,255,.6)}

.modal-foot{
  display:flex; align-items:center; justify-content:space-between;
  gap:10px;
  border-top:1px dashed rgba(14,37,22,.35);
  padding-top:10px; margin-top:10px;
}
.modal-coins{display:flex; gap:10px; align-items:baseline}

.game-grid{display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:10px}
.game-tile{
  border:1px solid rgba(14,37,22,.35);
  background:rgba(255,255,255,.48);
  border-radius:14px;
  padding:12px;
  cursor:pointer;
  text-align:left;
}
.game-tile:hover{border-color:rgba(57,198,255,.65)}
.gt-title{font-weight:900}
.gt-desc{opacity:.85; margin-top:4px; font-size:.9rem}

.game-stage{min-height:190px; display:grid; gap:10px}
.stage-head{display:flex; justify-content:space-between; align-items:baseline; font-weight:900}
.stage-box{border:1px solid rgba(14,37,22,.35); background:rgba(255,255,255,.42); border-radius:14px; padding:12px}

.coin-board{display:grid; grid-template-columns:repeat(4,1fr); gap:10px}
.coin-btn{
  height:56px;
  border-radius:14px;
  border:1px solid rgba(14,37,22,.35);
  background:rgba(255,255,255,.35);
  cursor:pointer;
  font-size:18px;
}
.coin-btn.on{background:rgba(255,209,102,.55)}

.reaction-btn{
  height:64px;
  border-radius:16px;
  border:2px solid rgba(14,37,22,.35);
  background:rgba(255,255,255,.42);
  cursor:pointer;
  font-weight:900;
  letter-spacing:1px;
}

/* Meters & log */
.meters{display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:12px}
@media (max-width:520px){ .meters{grid-template-columns:1fr} }
.meter-label{font-family:var(--mono); font-weight:900; font-size:.9rem}
.bar{
  height:12px;
  border-radius:999px;
  background:rgba(14,37,22,.15);
  border:1px solid rgba(14,37,22,.25);
  overflow:hidden;
}
.fill{
  height:100%;
  width:50%;
  background:linear-gradient(90deg, rgba(14,37,22,.88), rgba(14,37,22,.65));
  border-radius:999px;
  transition: width .25s ease;
}

.log{border-top:1px dashed rgba(14,37,22,.35); padding-top:10px}
.log-title{font-family:var(--mono); font-weight:900; letter-spacing:1px; margin-bottom:6px}
.log-list{margin:0; padding-left:18px; max-height:120px; overflow:auto; font-family:var(--mono)}
.log-list li{margin:4px 0}

/* Controls */
.controls{padding:0 16px 16px 16px}
.control-row{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px}
.btn{
  border:1px solid rgba(42,59,82,.85);
  background:linear-gradient(180deg, rgba(15,21,32,.9), rgba(8,10,14,.9));
  color:var(--ink);
  padding:12px 14px;
  border-radius:14px;
  font-weight:900;
  cursor:pointer;
  letter-spacing:.2px;
  box-shadow:0 10px 20px rgba(0,0,0,.22);
}
.btn:hover{border-color:rgba(76,255,144,.55)}
.btn:active{transform:translateY(1px)}
.btn.small{padding:10px 12px; border-radius:12px}

.control-row.secondary{align-items:center; justify-content:space-between; gap:12px}
.wallet{display:flex; gap:10px; align-items:baseline; font-family:var(--mono)}
.wallet .value{font-weight:900; color:var(--accent)}
.namebox{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
.namebox input,
.weather-row input{
  background:rgba(15,21,32,.75);
  border:1px solid rgba(42,59,82,.85);
  color:var(--ink);
  padding:10px 12px;
  border-radius:12px;
  outline:none;
}
.namebox input:focus,
.weather-row input:focus{border-color:rgba(57,198,255,.7)}

/* Side panel cards */
.panel{display:grid; gap:18px}
.card{
  background:linear-gradient(180deg, rgba(15,21,32,.85), rgba(8,10,14,.85));
  border:1px solid rgba(42,59,82,.85);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:16px;
}
.card h2{margin:0 0 8px 0; letter-spacing:.3px}
.muted{color:var(--muted)}
.muted.small{font-size:.92rem; margin:8px 0 0 0}

.tips{margin:10px 0 0 0; padding-left:18px; color:var(--muted)}
.badge-row{display:flex; flex-wrap:wrap; gap:8px; margin-top:14px}
.badge{
  font-family:var(--mono);
  font-size:.85rem;
  padding:6px 10px;
  border-radius:999px;
  border:1px solid rgba(42,59,82,.85);
  background:rgba(19,26,37,.45);
}

.footer{
  width:min(1120px, 92vw);
  margin:0 auto 26px;
  padding:6px 0;
  border-top:1px solid rgba(42,59,82,.65);
}

/* Shop tabs */
.tabs{display:flex; gap:8px; margin:10px 0 12px 0}
.tab{
  flex:1;
  border:1px solid rgba(42,59,82,.85);
  background:rgba(19,26,37,.55);
  color:var(--ink);
  padding:10px;
  border-radius:12px;
  font-weight:900;
  cursor:pointer;
}
.tab.active{border-color:rgba(57,198,255,.65)}
.tab:hover{border-color:rgba(76,255,144,.55)}

.shop{display:grid; gap:10px; margin-top:10px}
.shop-item{
  display:grid;
  grid-template-columns:46px 1fr auto;
  gap:10px;
  align-items:center;
  text-align:left;
  padding:12px;
  border-radius:14px;
  border:1px solid rgba(42,59,82,.85);
  background:rgba(19,26,37,.55);
  cursor:pointer;
}
.shop-item:hover{border-color:rgba(57,198,255,.65)}
.shop-item:disabled{opacity:.55; cursor:not-allowed}
.shop-ico{
  width:46px;height:46px;border-radius:14px;
  display:grid;place-items:center;
  background:rgba(57,198,255,.14);
  border:1px solid rgba(57,198,255,.25);
  font-size:22px;
}
.shop-name{font-weight:900}
.shop-desc{color:var(--muted); font-size:.9rem}
.shop-price{
  font-family:var(--mono);
  font-weight:900;
  color:var(--warn);
  background:rgba(255,209,102,.12);
  border:1px solid rgba(255,209,102,.25);
  padding:6px 10px;
  border-radius:999px;
}
.shop-tag{
  margin-left:10px;
  font-family:var(--mono);
  font-weight:900;
  color:var(--accent2);
  border:1px solid rgba(57,198,255,.35);
  padding:6px 10px;
  border-radius:999px;
  background:rgba(57,198,255,.10);
}

/* Weather */
.weather-row{display:flex; gap:10px; margin-top:10px}
.weather-row input{flex:1}
.weather-box{
  margin-top:12px;
  border:1px solid rgba(42,59,82,.85);
  border-radius:14px;
  background:rgba(19,26,37,.45);
  padding:12px;
  font-family:var(--mono);
}
.wb-line{display:flex; justify-content:space-between; gap:10px; padding:4px 0}
.label{opacity:.9}
.value{color:var(--ink); font-weight:900}
